/*!
 * @license lightsaber v1.0.3
 * (c) 2014 sugarshin https://github.com/sugarshin
 * License: MIT
 */
(function(){var t,n,e,o=function(t,n){return function(){return t.apply(n,arguments)}},r={}.hasOwnProperty,i=function(t,n){function e(){this.constructor=t}for(var o in n)r.call(n,o)&&(t[o]=n[o]);return e.prototype=n.prototype,t.prototype=new e,t.__super__=n.prototype,t};e=function(){function t(){}return t.prototype.addEvent=function(t,n,e){return t.addEventListener(n,e)},t.prototype.rmEvent=function(t,n,e){return t.removeEventListener(n,e)},t}(),t=function(){function t(t,n,e){this.context=t,this.urlList=n,this.onload=e,this.bufferList=[],this.loadCount=0}return t.prototype.loadBuffer=function(t,n){var e;return e=new XMLHttpRequest,e.open("GET",t,!0),e.responseType="arraybuffer",e.onload=function(o){return function(){return o.context.decodeAudioData(e.response,function(e){return e||console.error(t),o.bufferList[n]=e,++o.loadCount===o.urlList.length&&"function"==typeof o.onload?o.onload(o.bufferList):void 0},function(t){return console.error(t)})}}(this),e.onerror=function(){return console.error("error")},e.send()},t.prototype.load=function(){var t,n;for(t=0,n=[];t<this.urlList.length;)this.loadBuffer(this.urlList[t],t),n.push(++t);return n},t}(),n=function(n){function e(n,e){this.shake=o(this.shake,this),this.startBtn=e,this.context=new r,this.bufferLoader=new t(this.context,n),this.bufferLoader.load(),this.isPlaying=!1,this.isStart=!1,this.events()}var r;return i(e,n),r=window.AudioContext||window.webkitAudioContext,e.prototype.soundPlay=function(t,n){return this.source=this.context.createBufferSource(),this.gainNode=this.context.createGain(),this.source.buffer=t,this.source.connect(this.gainNode),this.gainNode.connect(this.context.destination),this.gainNode.gain.value=null!=n?n:0,this.isStart===!1&&this.source.start(0),this.isPlaying===!1&&this.isStart===!0?(this.source.start(0),this.isPlaying=!0,this.source.onended=function(t){return function(){return t.isPlaying=!1}}(this)):void 0},e.prototype.shake=function(t){var n,e,o,r;return n=t.accelerationIncludingGravity,20>(e=n.x)&&e>15||20>(o=n.y)&&o>15||20>(r=n.z)&&r>15?this.soundPlay(this.bufferLoader.bufferList[2],1):n.x>30||n.y>30||n.z>30?this.soundPlay(this.bufferLoader.bufferList[3],1):void 0},e.prototype.start=function(){return this.soundPlay(this.bufferLoader.bufferList[0],1),this.addMotionEvent(),this.isStart=!0,document.getElementById("sword").style.display="block"},e.prototype.end=function(){return this.soundPlay(this.bufferLoader.bufferList[4],1),this.rmMotionEvent(),this.isStart=!1,document.getElementById("sword").style.display="none"},e.prototype.toggle=function(){return this.isStart===!1?this.start():this.end()},e.prototype.events=function(){return this.addEvent(this.startBtn,"click",function(t){return function(){return t.toggle()}}(this))},e.prototype.addMotionEvent=function(){return this.addEvent(window,"devicemotion",this.shake)},e.prototype.rmMotionEvent=function(){return this.rmEvent(window,"devicemotion",this.shake)},e}(e),window.Lightsaber||(window.Lightsaber=n)}).call(this);